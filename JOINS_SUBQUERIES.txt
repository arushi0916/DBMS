2.1 Joins and Subqueries

1.SELECT STAFF_NAME,DEPARTMENT_MASTER.DEPT_CODE, DEPT_NAME FROM STAFF_MASTER, DEPARTMENT_MASTER WHERE STAFF_SAL >20000;
2.
3.SELECT S.STUDENT_CODE, S.STUDENT_NAME, B.BOOK_CODE, B.BOOK_NAME FROM STUDENT_MASTER S, BOOK_MASTER B, BOOK_TRANSACTIONS 
  WHERE BOOK_EXPECTED_RETURN_DATE = SYSDATE;
4.SELECT S.STAFF_NAME, S.STAFF_CODE, DM.DEPT_NAME, DSM.DESIGN_NAME, BT.BOOK_CODE, BM.BOOK_NAME, BT.BOOK_ISSUE_DATE FROM 
  STAFF_MASTER S, DESIGNATION_MASTER DSM, DEPARTMENT_MASTER DM, BOOK_MASTER BM, BOOK_TRANSACTIONS BT WHERE 
  DSM.DESIGN_CODE=S.DESIGN_CODE AND DM.DEPT_CODE=S.DEPT_CODE AND S.STAFF_CODE=BT.STAFF_CODE AND BT.BOOK_CODE=BM.BOOK_CODE 
  AND BOOK_ISSUE_DATE < '01-APR-11';
5.SELECT S.STAFF_NAME, S.STAFF_CODE, DM.DEPT_NAME, DSM.DESIGN_NAME, BT.BOOK_CODE, BM.BOOK_NAME, BM.BOOK_PUB_AUTHOR, 
  5*(DATEDIFF(BT.ACTUAL_RETURN_DATE, BT.EXPEXTED_RETURN_DATE)) FROM
  STAFF_MASTER S, DESIGNATION_MASTER DSM, DEPARTMENT_MASTER DM, BOOK_MASTER BM, BOOK_TRANSACTIONS BT WHERE 
  DSM.DESIGN_CODE=S.DESIGN_CODE AND DM.DEPT_CODE=S.DEPT_CODE AND S.STAFF_CODE=BT.STAFF_CODE AND BT.BOOK_CODE=BM.BOOK_CODE AND
  (DATEDIFF(BT.ACTUAL_RETURN_DATE, BT.EXPECTED_RETURN_DATE)) > 0; 
  
    
  
6.SELECT STAFF_CODE, STAFF_NAME, STAFF_SAL FROM STAFF_MASTER WHERE STAFF_SAL < (SELECT AVG(STAFF_SAL) FROM STAFF_MASTER); 
7.SELECT BOOK_PUB_AUTHOR, BOOK_NAME FROM BOOK_MASTER WHERE BOOK_PUB_AUTHOR = (SELECT BOOK_PUB_AUTHOR FROM BOOK_MASTER 
  GROUP BY BOOK_PUB_AUTHOR HAVING COUNT(BOOK_CODE)>1);
8.SELECT S.STAFF_CODE, S.STAFF_NAME, D.DEPT_NAME FROM STAFF_MASTER S, DEPARTMENT_MASTER D, BOOK_TRANSACTIONS B WHERE 
  S.DEPT_CODE=D.DEPT_CODE AND S.STAFF_CODE=B.STAFF_CODE AND B.STAFF_CODE IN (SELECT B.STAFF_CODE FROM BOOK_TRANSACTIONS B 
  GROUP BY B.STAFF_CODE HAVING COUNT(B.BOOK_CODE)>1); 
9. SELECT S.STUDENT_CODE, S.STUDENT_NAME, DM.DEPT_NAME FROM STUDENT_MASTER S, DEPARTMENT_MASTER DM WHERE S.DEPT_CODE=DM.DEPT_CODE 
   AND DM.DEPT_CODE = (SELECT * FROM (SELECT DEPT_CODE FROM STUDENT_MASTER GROUP BY DEPT_CODE ORDER BY DEPT_CODE) WHERE ROWNUM=1);
10.
11.
13.SELECT DM.DEPT_CODE, DM.DEPT_NAME, (SELECT * FROM (SELECT COUNT(*) FROM STUDENT_MASTER S, STAFF_MASTER SF, DEPARTMENT_MASTER DM 
   WHERE S.DEPT_CODE=DM.DEPT_CODE AND SF.DEPT_CODE=DM.DEPT_CODE GROUP BY DM.DEPT_CODE) WHERE ROWNUM=1) FROM DEPARTMENT_MASTER DM ;   
  